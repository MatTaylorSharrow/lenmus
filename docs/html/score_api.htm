<html>
<head>
<title>LenMus: Score API</title>
<!-- RCS-ID: $Id$ -->
<link rel="stylesheet" media="all" href="singledoc.css" type="text/css" />
</head>
<body>
<h1>Score API</h1>
<p>Two groups of methods:
<ol>
<li>For creation and modification</li>
<li>For traversing and analyzing</li>
</ol>
<h2>Representation of a score</h2>
<p>A score is treated as a hierarchy: each score contains 0 or more staves and each staff
contains `staff objects' (staffobjs). Clefs, text and chords are all different types of
staff objects.</p>

<h2>Traversing methods</h2>

<h3>VStaff methods</h3>
<p>int GetNumMeasures();</p>
<p>lmStaffObjIterator* CreateIterator(ETraversingOrder nOrder);</p>
<p>int GetNumStaves();</p>
<p>lmStaff* GetFirstStaff();</p>
<p>lmStaff* GetNextStaff();</p>
<p>lmStaff* GetLastStaff();</p>
<p>lmStaff* GetStaff(int nStaff);</p>


<h3>Staff Objects traversing methods</h3>
<p>Once an iterator has been created, the iterator admits the following methods:</p>
<p>bool EndOfList();</p>
<p>lmStaffObj* GetCurrent();</p>
<p>void AdvanceToMeasure(int nBar);</p>
<p>void MoveFirst();</p>
<p>void MoveNext();</p>
<p>void MovePrev();</p>
<p>void MoveLast();</p>
<p>void BackToItemOfType(EScoreObjType nType);</p>
<p>void GoToItem(lmStaffObj* pSO);</p>

<h2>Working with staff objects iterators</h2>
<p>Usually it is necessary to do some operation to every staff in a score, or every bar 
in a staff, or every note in a score.</p>
<p>Three posibilities:</p>
<ol>
<li>traverse the staff objects in chronological order (eTR_ByTime), or</li>
<li>do it in the order they are internally stored (eTR_AsStored), or</li>
<li>do it in the fastest method (eTR_OptimizeAccess).</li>
</ol>

<p>The procedure is as follows:</p>
<ol>
<li>Create an iterator of the most appropiate type. After creation current element pointer
points to first staff object (according to selected ordering)</li>
<li>It can be tested test if current element points to a valid Staff object by
using method EndOfList()</li>
<li>TO reposition curren element pointer use methods AdvanceToMeasure(), MoveFirst(),
MoveNext(), MovePrev(), MoveLast(), BackToItemOfType() and GoToItem().</li>
<li>Finally, when the iterator is no longer needed, destroy it. This is important; otherwise
you will get memory leaks!</li>
</ol>
<p>Example:</p>
<pre class="example">
    lmStaffObj* pSO;
    lmStaffObjIterator* pIter = pVStaff->CreateIterator(eTR_ByTime);
    while(!pIter->EndOfList()) {
        pSO = pIter->GetCurrent();
        // ...do something with pSO
        pIter->MoveNext();
    }
    delete pIter;
</pre>


</body>
</html>
