<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE book PUBLIC "-//OASIS//DTD DocBook XML V4.1.2//EN"
               "http://www.oasis-open.org/docbook/xml/5.0b.5/docbook.dtd">

<book id="book">
<bookinfo>
<title>LenMus eMusicBooks' file format</title>
<subtitle>Version 1.1. Revision: February 2007</subtitle>

<author>
<surname>LenMus team</surname>
</author>

<legalnotice id="legal_notice">

<title>Legal Notice</title>
<para>Permission is granted to copy, distribute, and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.2 or any later
version published by the Free Software Foundation; with no Invariant Sections, 
no Front-Cover Texts, and no Back-Cover Texts. A copy of the license
is available at 
<ulink url="http://www.gnu.org/licenses/fdl.html">http://www.gnu.org/licenses/fdl.html</ulink>.
</para>

<para>This document may be copied and distributed in any medium, either
commercially or noncommercially, provided that the GNU Free Documentation
License (FDL), the copyright notices, and the license notice saying
the GNU FDL applies to the document are reproduced in all copies, 
and that you add no other conditions whatsoever to those of the GNU FDL. 
</para>

</legalnotice>

<copyright>
<year>2006-2007</year>
<holder>Cecilio Salmeron</holder>
</copyright>
</bookinfo>

<preface id="preface">
<title>Preface</title>

<para>
To be written.
</para>
</preface>

<chapter id="chIntro">
<title>LenMus eMusicBooks' file format</title>

<para>LenMus is a reader for books about music. These book are not part of the program
and anyone can write them. This document is intended to describe the format of the
eMusicBooks' files.</para>

<para>eMusicBooks are written in XML format. 
The reason to choose XML as the format for eMusicBooks is due to its advantages. Among them
I would emphasize:</para>
<itemizedlist>
<listitem>The files are also readable by
    humans, and can be created and edited with any
    text editor.</listitem>
<listitem>XML allows to separate content from presentation. The author can concentrate on
    the content and the presentation can be later changed or chosen to suit different needs.
    </listitem>
<listitem>XLM allows for "single-sourcing", that is, it permits to generate multiple 
    delivery formats, such as HTML, PDF, online help, etc., from the same source file.</listitem>
</itemizedlist>
   
<para>As an eMusicBook is just a book about music, I have decide to take advantage of the widely used
'DocBook' XML format. The DocBook markup language is maintained by the OASIS consortium and
is specifically suited for software documentation, I have added a few specific tags
for LenMus purposes and have taken many of the tags from DocBook, so that people 
having good knowledge of this format will find easy to write eMusicBooks.</para>

<para>The eMusicBook format consists of tags, such as &lt;book&gt;, each with corresponding
ending tags such as &lt;/book&gt;, and textual content, such as "This is a line of text".
Here you have a simple example:</para>

<programlisting>
&lt;book id="first_book"&gt;
  &lt;title&gt;My first eMusicBook&lt;/title&gt;

  &lt;theme id="p1"&gt;
    &lt;title&gt;Page 1&lt;/title&gt;
    &lt;para&gt;Hello world!&lt;/para&gt;
    &lt;para&gt;This is my first music eMusicBook!&lt;/para&gt;
  &lt;/theme&gt;

  &lt;theme id="p2"&gt;
    &lt;title&gt;Page 2&lt;/title&gt;
    &lt;para&gt;Have a good day!&lt;/para&gt;
  &lt;/theme&gt;

&lt;/book&gt;
</programlisting>


<para>The complete content of the document (a "book") has been structured into
two "themes", each with a "title" and consisting of one or more "para(graphs)".</para>

<anchor id="theme"/>
<para>eMusicBooks are structured as conventional printed books, in chapter, sections,
sub-sections, etc.. But the final structuring chunk is the <command>theme</command>,
that is, the information that is going to be displayed in a page. This is the main
difference with books in paper: paper has finite physical dimensions so text flows
from one page to the next one. But the 'page' in a computer display can have an
infinite dimension, so you must decide how you would like to chunk the document to
present it to the reader. Each chunk is named a <command>theme</command>.</para>

<para>Therefore, a <command>book</command> is a collection of <command>themes</command>, organized
in <command>chapters</command> and <command>sections</command>, and sections can also have sub-sections.
For example:</para>

<programlisting>
&lt;book id="first_book"&gt;
  &lt;title&gt;My first eMusicBook&lt;/title&gt;

  &lt;chapter id="ch1"&gt;
  &lt;title&gt;The first chapter&lt;/title&gt;

    &lt;section id="s1"&gt;
    &lt;title&gt;Section one&lt;/title&gt;
      &lt;theme id="p1"&gt;
        &lt;title&gt;Page 1&lt;/title&gt;
        &lt;para&gt;Hello world!&lt;/para&gt;
        &lt;para&gt;This is my first music eMusicBook!&lt;/para&gt;
      &lt;/theme&gt;
    &lt;/section&gt;

    &lt;section id="s2"&gt;
    &lt;title&gt;Section two&lt;/title&gt;
      &lt;theme id="p2"&gt;
        &lt;title&gt;Page 2&lt;/title&gt;
        &lt;para&gt;Have a good day!&lt;/para&gt;
      &lt;/theme&gt;
    &lt;/section&gt;

&lt;/book&gt;
</programlisting>

<para>Themes can has also internal structure, but sections inside a theme
will be named <command>parts</command>.</para>

<para>Indenting and all whitespace is ignored except in some verbatim elements.</para>

<para>Notice how the tags indicate the structure and meaning of the content, but not
its appearance. There is nothing to say "put this paragraph in bold-face type" or
"center this on the page". This is by design. The same eMusicBook
file can be processed into many different output formats, each with a completely
different appearance and even a different arrangement of content elements. So authors
must put the emphasis on content not on appearance.</para>

<para>Sections and parts can be nested to create sub-sections and sub-parts. For example:</para>


<programlisting>
    &lt;section&gt;
        &lt;section&gt;
            &lt;section&gt;...&lt;/section&gt;
            &lt;section&gt;
                &lt;section&gt;
                    &lt;section&gt;...&lt;/section&gt;
                    &lt;section&gt;...&lt;/section&gt;
                &lt;/section&gt;
                &lt;section&gt;...&lt;/section&gt;
            &lt;/section&gt;
        &lt;/section&gt;
        &lt;section&gt;...&lt;/section&gt;
    &lt;/section&gt;
    &lt;section&gt;...&lt;/section&gt;
    &lt;section&gt;...&lt;/section&gt;
</programlisting>

<para>No theoretical limit on depth of nesting.</para>

<!-- =========================================================================== -->
<sect1 id="title"><title>Tags to use: the eMusicBook DTD</title>

<para>To write an eMusicBook you need to know the set of tags that can be used.
The formal way of defining this is by using a <command>Document Type Definition</command> or
DTD. The DTD is an special file defining the legal XML tags and attributes
that an author can
use, and how they relate to each other. For example, a <command>book</command> element can
contain a <command>title</command> element, any number of <command>para</command> elements for paragraphs,
and any number of <command>chapter</command> elements. It also serves to automatically checking
your document against the valid element names and rules, so to verify
that your XML document is correct. Using the DTD and XML syntax, authors
mark up their text content with tag names enclosed in angle brackets
like &lt;chapter&gt;. The markup is similar to HTML, but with more tags and
tighter rules.</para>

</sect1>

<!-- =========================================================================== -->
<sect1 id="bookinfo"><title>Starting a document</title>

<para>All eMusicBook documents always start with the xml declaration file type,
followed by a reference to the eMusicBook DTD. And then the eMusicBook content
enclosed by a &lt;book&gt; tag:</para>

<programlisting>
&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE book PUBLIC "-//LenMus//DTD eMusicBook 1.0//EN"
    "http://www.lenmus.org/dtd/eMusicBook.dtd&gt;

&lt;book&gt;
&lt;bookinfo&gt;
    &lt;title&gt;Music Reading exercises&lt;/title&gt;
    &lt;author&gt;Jim Smith&lt;/author&gt;
    &lt;abstract&gt;General exercises, customizable to suit your needs at any
        moment.&lt;/abstract&gt;
    &lt;copyright&gt;
        &lt;year&gt;2002-2006&lt;/year&gt;
        &lt;holder&gt;Jim Smith&lt;/holder&gt;
    &lt;/copyright&gt;
    &lt;legalnotice&gt;
        &lt;para&gt;Permission is granted to copy, distribute and/or modify this document
        under the terms of the GNU Free Documentation License, Version 1.2 or any
        later version published by the Free Software Foundation; with no Invariant
        Sections, with no Front-Cover Texts, and with no Back-Cover Texts. 
        A copy of the license is included in the documentation received with
        this program, and is also available at 
        &lt;ulink url="http://www.gnu.org/licenses/fdl.html"&gt;http://www.gnu.org/licenses/fdl.html&lt;/ulink&gt;.
        &lt;/para&gt;

        &lt;para&gt;
        This document may be copied and distributed in any medium, either
        commercially or noncommercially, provided that the GNU Free Documentation
        License (FDL), the copyright notices, and the license notice saying
        the GNU FDL applies to the document are reproduced in all copies, 
        and that you add no other conditions whatsoever to those of the GNU FDL.
        
        &lt;/para&gt;
    &lt;/legalnotice&gt;
&lt;/bookinfo&gt;

<para>
</para>

   ... here the book content

&lt;/book&gt;
</programlisting>

<para>The &lt;bookinfo&gt; tag contains all meta-information about the book:
A brief summary paragraph, to be included in the cover page (abstract) and copyright and
legal information.</para>


</sect1>

<!-- =========================================================================== -->
<sect1 id="creating_toc"><title>Creating a Table of Content (TOC)</title>
<para>When processing an eMusicBook, LenMus automatically compiles a table of
content for the book.
The TOC is formed by all chapters, sections and themes unless they have the attribute
'toc="no"'. Default value, if nothing specified, is toc="yes".</para>
<para>The TOC is
structured following the structure of the included chapters, sections and themes.
Notice that parts inside a theme are not included in the TOC.</para>

<para>When displaying the TOC of an eMusicBook in the navigation panel of the LenMus
program it is possible to include images instead of (or beside of) titles.
These images must be specified by using tag &lt;tocimage&gt; when defining chapters, sections
and themes. &lt;tocimage&gt; tag must go before the &lt;title&gt; tag. For example:</para>

<programlisting>
&lt;theme id="ch205"&gt;
&lt;tocimage&gt;img205.png&lt;/tocimage&gt;
&lt;title&gt;8th note tied to group of one 8th and two 16th notes&lt;/title&gt;

&lt;para&gt;In this lesson .....
</programlisting>

<para>The image must not contain path information as all images for an eMusicBook
must be stored in the same folder than the book XML files.</para>


</sect1>

<!-- =========================================================================== -->
<sect1 id="indexes"><title>Indexes</title>
<para>When processing an eMusicBook, LenMus automatically compiles an index. To establish
that a term is placed in the index, we have to mark it as being indexed.
Doing so is simple, we just use the &lt;indexterm&gt; tag and give the
term a name. Example:
</para>

<programlisting>
This note is also known in British English as 'crochet'
&lt;indexterm&gt;crochet&lt;indexterm&gt;, and its usage...
</programlisting>



</sect1>

<!-- =========================================================================== -->
<sect1 id="tags_for_content"><title>Tags for content</title>

<para>Most tags for content are taken from DocBook (see
appendix <link linkend="ap2">Tags cross-reference</link>). 
The most used tag is the one to write paragraphs: &lt;para&gt;.</para>

<para>Example.</para>
<programlisting>
&lt;para&gt;
This is a very short paragraph
&lt;/para&gt;
</programlisting>

<para>Tag &lt;para&gt; can have one attribute: role='center' to indicate that
text must be displayed centered on the page. For example:
</para>

<programlisting>
&lt;para role='center'&gt;
This is a centered short paragraph
&lt;/para&gt;
</programlisting>

<para>Other available tags, apart of tag &lt;para&gt;, are going to be described
in the following sections.</para> 

</sect1>

<!-- =========================================================================== -->
<sect1 id="lists"><title>Lists</title>

<para>
An 'itemized' list is a list in which each entry is marked with a bullet or other dingbat. Example:</para>
<informaltable>
<tgroup cols="2">
<thead>
<row>
<entry>Source</entry>
<entry>Output</entry>
</row>
</thead>
<tbody>

<row>
<entry>
<programlisting>
&lt;para&gt;This is my shopping list:&lt;/para&gt;
&lt;itemizedlist&gt;
&lt;listitem&gt;Apples&lt;/listitem&gt;
&lt;listitem&gt;Tomatos (but red)&lt;/listitem&gt;
&lt;listitem&gt;Carrots and beans&lt;/listitem&gt;
&lt;/itemizedlist&gt;
</programlisting>
</entry>

<entry>
<para>This is my shopping list:</para>
      <itemizedlist>
        <listitem>Apples</listitem>
        <listitem>Tomatos (but red)</listitem>
        <listitem>Carrots and beans</listitem>
      </itemizedlist>
</entry>
</row>

</tbody>
</tgroup>
</informaltable>


<para>
An 'ordered' list is a list in which each entry is marked with a sequentially incremented
label, usually numerical. Example:</para>
<informaltable>
<tgroup cols="2">
<thead>
<row>
<entry>Source</entry>
<entry>Output</entry>
</row>
</thead>
<tbody>

<row>
<entry>
<programlisting>
&lt;para&gt;This is my shopping list:&lt;/para&gt;
&lt;orderedlist&gt;
&lt;listitem&gt;Apples&lt;/listitem&gt;
&lt;listitem&gt;Tomatos (but red)&lt;/listitem&gt;
&lt;listitem&gt;Carrots and beans&lt;/listitem&gt;
&lt;/orderedlist&gt;
</programlisting>
</entry>

<entry>
    <para>This is my shopping list:</para>
      <orderedlist>
        <listitem>Apples</listitem>
        <listitem>Tomatos (but red)</listitem>
        <listitem>Carrots and beans</listitem>
      </orderedlist>
</entry>
</row>

</tbody>
</tgroup>
</informaltable>


</sect1>

<!-- =========================================================================== -->
<sect1 id="images"><title>Images</title>

<para>
To include an image tag &lt;imagedata&gt; can be used. The image is rendered inline, that is,
no linebreak takes place before and after the image is included.
The filename to include is provided in attribute 'fileref'. Optional
additional attributes are 'align' and 'valign'. Example:
</para>

<programlisting>
&lt;para role='center'&gt;
&lt;imagedata fileref='figure2.png' /&gt;
&lt;/para&gt;
</programlisting>

<para>Attribute 'fileref' must be the file name, without path information. All images
must be stored in a subfolder, named 'figures', placed in the same folder than the xml 
eBook files.
</para>

</sect1>

<!-- =========================================================================== -->
<sect1 id="links"><title>Links</title>

<para>Its is possible to include two types of links: external, to an URL, or
internal, to other themes of the eMusicBook or to another eMusicBook.
The tags to use are different:</para>


<para>External links (links to an URL):</para>

<programlisting>
&lt;ulink url="http://www.lenmus.org/&gt;visit our website&lt;/ulink&gt;
<!--&lt;ulink url='#LenMusPage/SingleExercises_ch0.htm'&gt; a link to theme 'id=ch0' of book 'SingleExercises'-->
&lt;ulink url='#LenMusPage/SingleExercises.lmb'&gt; a link to cover page of book 'SingleExercises'
&lt;ulink url='#LenMusPage/Exercises for ear training'&gt; a link to a theme whose title is 'Exercises for ear training'
</programlisting>

<para>Internal links are based on the eMusicBook title and on the id attributes added to
the themes:</para>

<programlisting>
&lt;link linkend="idname"&gt;Internal link&lt;/link&gt; a link to theme 'idname' of this book
</programlisting>

<para>
Example:
</para>

<programlisting>
&lt;section id="introduction&gt;
...
&lt;/section&gt;

&lt;section id="another&gt;
&lt;para&gt;
    For more info see the &lt;link linkend="introduction"&gt;intro
    section&lt;/link&gt;.
&lt;/para&gt;
</programlisting>



</sect1>

<!-- =========================================================================== -->
<sect1><title>Including scores and interactive exercises</title>

<para>Scores and interactive exercises are included by using the &lt;score&gt; and
&lt;exercise&gt; tags, respectively. These tags and their content is explained in detail
in <link linkend="ch2">chapter 2</link>.</para>

</sect1>

<!-- =========================================================================== -->
<sect1><title>Splitting a book into several files</title>

<para>Usually, for large eMusicBooks, you may want to break it up into multiple files,
as a book in a single file may not be the easiest thing to work with.

Luckily this is easy to do. FOr example, if you create a two files, part1.xml and part2.xml,
with the following content:</para>

<programlisting>
File 'part1.xml':

    &lt;theme&gt;
    &lt;title&gt;On Foo's&lt;/title&gt;
        &lt;para&gt;
        Stuff about Foo's goes here.
        &lt;/para&gt;
    &lt;/theme&gt;
</programlisting>

<programlisting>
File 'part2.xml':

    &lt;theme&gt;
    &lt;title&gt;On Bars's&lt;/title&gt;
          &lt;para&gt;
          Stuff about Bars's goes here.
          &lt;/para&gt;
    &lt;/theme&gt;
</programlisting>

<para>And creates a main file like:</para>

<programlisting>
&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE book PUBLIC "-//LenMus//DTD eMusicBook 1.0//EN"
    "http://www.lenmus.org/dtd/eMusicBook.dtd" [
  &lt;!ENTITY chapter1 SYSTEM "part1.xml&gt;
  &lt;!ENTITY chapter2 SYSTEM "part2.xml&gt;
]&gt;

&lt;book&gt;
  &lt;title&gt;Splitted book&lt;/title&gt;

  &lt;theme&gt;
  &lt;title&gt;Preface&lt;/title&gt;
    &lt;para&gt;
    This is a book splitted into three files
    &lt;/para&gt;
  &lt;/theme&gt;

  &amp;chapter1;
  &amp;chapter2;

&lt;/book&gt;
</programlisting>

<para>The use of the &lt;!ENTITY&gt; tags creates entities named 'chapter1' and 'chapter2'.
Using them automatically includes their contents in to the main.xml
file, so be careful to not put the &lt;?xml?&gt; preprocessor tags in
the included files (part1.xml and part2.xml respectively).</para>

</sect1>

<!-- =========================================================================== -->
<sect1><title>Translation</title>
<para>Translating an eMusicBook requires the translation of the contents but a lot
of care have to be put to not translate the tags or the attribute values. So,
to minimize problems and to simplify translators life and translations coordination,
the following schema will be used: all eBooks are written, initially, in English.
The source XML eBook is then
compiled using lenmus utility 'LangTool', that generates the LMB compiled eBook format used
by LenMus. For translation, LangTool relies on PO files containing the translations for
all strings in the eBook. LangTool is also used to generate a PO file from the source
XML eBook.</para>

<para>The steps to translate an eMusicBook are, basically:</para>

<orderedlist>
<listitem>Process the eMusicBook with LangTool to generate the PO file for the required language.</listitem>
<listitem>Send the PO file to the translators.</listitem>
<listitem>When the translation is received, generate the compiled MO file.</listitem>
<listitem>Using LangTool, generate the translated eMusicBook in LenMus compiled format (.LMB).</listitem>

</orderedlist>

<para>These steps are performed by the LenMus Translations Coordinator.</para>



</sect1>

</chapter>



<!-- =============================================================== -->
<!-- ======================    Chapter 2   ========================= -->
<!-- =============================================================== -->

<chapter id="ch2">
<title>Including scores and interactive exercises</title>

<para>Scores and interactive exercises are included by using the &lt;score&gt; and
&lt;exercise&gt; tags, respectively. The content of these tags are a group of parameters
for configuring the exercise or for defining the score and the controls.
The possible tags to use to set up an score or an exercise are described in 
the following sections.</para>

<sect1 id="scores">
<title>Including scores</title>

<para>Scores can be included by using the &lt;score&gt; tag. The &lt;score&gt; tag admits the
following parameters:</para>

<variablelist>
<varlistentry><term>&lt;score_type&gt;</term>
<listitem>Defines the type of score being included. Possible values: "short | short_nn_ss 
    | pattern | full | XMLFile | LDPFile". If this param is not specified, default 
    assumed value is: "full". In 'short_nn_ss' the meaning of 'nn' is the version number
    for the LDP language used, and 'ss' is the language (default: 'en').
    </listitem></varlistentry>

<varlistentry><term>&lt;music&gt;</term>
<listitem>Mandatory. Defines the score content. Depending on the previous parameter it 
    will be described using
    the LDP language or the MusicXML language.</listitem></varlistentry>

<varlistentry><term>&lt;music_border&gt;</term>
<listitem>Defines the type of score being included. Possible values:
    "0 | 1".
    If this param is not specified it is assumed: "0" (no border around score)
    </listitem></varlistentry>

<varlistentry><term>&lt;control_play&gt;</term>
<listitem>Include 'play' link. Default: do not include it.
    Value="play label|stop playing label". i.e.: "Play|Stop" Stop label
    is optional. Default labels: "Play|Stop"</listitem></varlistentry>


<varlistentry><term>&lt;control_solfa&gt;</term>
<listitem>Include 'solfa' link. Default: do not include it.
    Value="music read label|stop music reading label". i.e.:
    "Play|Stop". Stop label is optional.
    Default labels: "Read|Stop"</listitem></varlistentry>

<varlistentry><term>&lt;control_measures&gt;</term>
<listitem>Include 'play measure #' links, one per measure.
    Default: do not include them.
    Value="play label|stop label". i.e.:
    "Play|Stop". Stop label is optional.
    Default labels: "Measure %d|Stop %d"</listitem></varlistentry>
                        
</variablelist>

<para>Example:</para>
<programlisting>
&lt;score classid="Score" width="600" height="100" border="0&gt;
    &lt;score_type&gt;short&lt;/score_type&gt;
    &lt;music_border&gt;0&lt;/music_border&gt;
    &lt;control_play&gt;1&lt;/control_play&gt;
    &lt;music&gt;
        (Metrica 2 4)(n a4 c g+)(n a4 c l g-)(n a4 c g+)(n a4 s)(n a4 s g-)(Barra Doble))
        (c (n a4 c)(n a4 n)(n a4 s g+)(n a4 s g-)(Barra Final))
    &lt;/music&gt;
&lt;/score&gt;
</programlisting>


</sect1>

<!-- =========================================================================== -->
<sect1 id="exercises"><title>Including exercises</title>

<para>Interactive exercises can be included by using the &lt;exercise&gt; tag. All exercises
available in LenMus program can be embedded in an eMusicBook. Attribute 'type' specifies
the type of exercise:</para>

<itemizedlist>
    <listitem>type="TheoIntervals"</listitem>
    <listitem>type="TheoScales"</listitem>
    <listitem>type="TheoKeySignatures"</listitem>
    <listitem>type="EarIntervals"</listitem>
    <listitem>type="EarCompareIntervals"</listitem>
    <listitem>type="IdfyChord"</listitem>
    <listitem>type="IdfyScales"</listitem>
</itemizedlist>

<!-- ................................................................ -->
<sect2><title>Exercises on key signatures</title>

<variablelist>

<varlistentry><term>&lt;max_accidentals&gt;</term>
<listitem>Defines the maximum number of accidentals to use in the exercise.
    Possible values: A number from 0..7. If this param is not specified, default 
    assumed value is: "5".</listitem></varlistentry>
    
<varlistentry><term>&lt;problem_type&gt;</term>
<listitem>Defines the type of exercise. Possible values: "DeduceKey | WriteKey | Both". If this param is not specified, default 
    assumed value is: "Both".</listitem></varlistentry>
    
<varlistentry><term>&lt;clef&gt;</term>
<listitem>Possible values: "Sol | Fa4 | Fa3 | Do4 | Do3 | Do2 | Do1". 
    If this param is not specified, default 
    assumed value is: "Sol".</listitem></varlistentry>
    
<varlistentry><term>&lt;mode&gt;</term>
<listitem>Possible values: "Major | Minor | Both". If this param is not specified, default 
    assumed value is: "Both".</listitem></varlistentry>
    
</variablelist>

<para>Example</para>

<programlisting>
&lt;exercise type="TheoKeySignatures" width="100%" height="300" border="0&gt;
    &lt;max_accidentals&gt;7&lt;/max_accidentals
    &lt;problem_type&gt;both&lt;/problem_type&gt;
    &lt;clef&gt;sol&lt;/clef&gt;
    &lt;mode&gt;both&lt;/mode&gt;
&lt;/exercise&gt;
</programlisting>

</sect2>


<sect2><title>Exercises on intervals (theory)</title>

<variablelist>

<varlistentry><term>&lt;accidentals&gt;</term>
<listitem>Possible values: "none | simple | double". If this param 
    is not specified, default 
    assumed value is: "none".</listitem></varlistentry>

<varlistentry><term>&lt;problem_type&gt;</term>
<listitem>DPossible values: "DeduceInterval | BuildInterval | Both". If 
    this param is not specified, default 
    assumed value is: "Both".</listitem></varlistentry>

<varlistentry><term>&lt;clef&gt;</term>
<listitem>Possible values: "Sol | Fa4 | Fa3 | Do4 | Do3 | Do2 | Do1". If 
    this param is not specified, default 
    assumed value is: "Sol".</listitem></varlistentry>

</variablelist>

</sect2>


<sect2><title>Exercises on chords (theory and aural training)</title>

<variablelist>

<varlistentry><term>&lt;keys&gt;</term>
<listitem>Defines the allowed key signatures for the exercise. Possible values: Keyword
    "all" or a list of allowed key signatures, i.e.: "Do,Fas". If this param 
    is not specified, default 
    assumed value is: "all"</listitem></varlistentry>

<varlistentry><term>&lt;chords&gt;</term>
<listitem><para>Defines the allowed chords for the exercise. Possible values: Keyword
    "all" or a list of allowed chords:</para><para>
    m-minor, M-major, a-augmented, d-diminished, s-suspended</para><para>
    T-triad, dom-dominant, hd-half diminished</para><para>
    Examples:</para><para>
    triads: mT, MT, aT, dT, s4, s2</para><para>
    sevenths: m7, M7, a7, d7, mM7, aM7 dom7, hd7</para><para>
    sixths: m6, M6, a6</para>
    If this param is not specified, default 
    assumed value is: ""mT,MT,aT,dT,m7,M7"</listitem></varlistentry>

<varlistentry><term>&lt;mode&gt;</term>
<listitem>Possible values: "'theory' | 'earTraining'  Keyword 
    indicating type of exercise".</listitem></varlistentry>


<varlistentry><term>&lt;play_mode&gt;</term>
<listitem>Possible values: "'chord | ascending | descending' allowed 
    play modes. Default: chord".</listitem></varlistentry>


<varlistentry><term>&lt;show_key&gt;</term>
<listitem>Possible values: "'0 | 1' Default: 0 (do not display 
    key signature)".</listitem></varlistentry>


<varlistentry><term>&lt;inversions&gt;</term>
<listitem>Possible values: "'0 | 1' Default: 0 (do not allow 
    inversions)".</listitem></varlistentry>


<varlistentry><term>&lt;control_settings&gt;</term>
<listitem>Possible values: "[key for storing the settings]"
    By coding this param it is forced the inclusion of
    the 'settings' link. Its value will be used
    as the key for saving the user settings.".</listitem></varlistentry>

</variablelist>

<para>Example</para>

<programlisting>
&lt;exercise type="IdfyChord" width="100%" height="300" border="0&gt;
    &lt;mode&gt;earTraining&lt;/mode&gt;
    &lt;chords&gt;mT,MT,aT,dT,m7,M7,dom7&lt;/chords&gt;
    &lt;keys&gt;all&lt;/keys&gt;
&lt;/exercise&gt;
</programlisting>

</sect2>


<sect2><title>Exercises on scales (theory and aural training)</title>

<variablelist>

<varlistentry><term>&lt;keys&gt;</term>
<listitem>Possible values: Keyword "all" or a list of allowed key signatures, i.e.: "Do,Fas"
                    Default: all.</listitem></varlistentry>

<varlistentry><term>&lt;scales&gt;</term>
<listitem>Possible values: Keyword "all" or a list of allowed scales:
    m-minor, M-major, a-augmented, d-diminished, s-suspended
    T-triad, dom-dominant, hd-half diminished
    triads: mT, MT, aT, dT, s4, s2
    sevenths: m7, M7, a7, d7, mM7, aM7 dom7, hd7
    sixths: m6, M6, a6
    Default: "mT,MT,aT,dT,m7,M7".</listitem></varlistentry>


<varlistentry><term>&lt;mode&gt;</term>
<listitem>Possible values: "'theory' | 'earTraining'  Keyword indicating
    type of exercise.</listitem></varlistentry>


<varlistentry><term>&lt;play_mode&gt;</term>
<listitem>Possible values: "'ascending | descending | both' allowed play
    modes. Default: ascending.</listitem></varlistentry>


<varlistentry><term>&lt;show_key&gt;</term>
<listitem>Possible values: "'0 | 1' Default: 0 (do not display
    key signature).</listitem></varlistentry>


<varlistentry><term>&lt;control_settings&gt;</term>
<listitem>Possible values: "Value="[key for storing the settings]"
    By coding this param it is forced the inclusion of
    the 'settings' link. Its value will be used
    as the key for saving the user settings.</listitem></varlistentry>

</variablelist>

<para>Example</para>

<programlisting>
&lt;exercise type="IdfyScale" width="100%" height="300" border="0&gt;
    &lt;mode&gt;earTraining&lt;/mode&gt;
    &lt;scales&gt;mT,MT,aT,dT,m7,M7,dom7&lt;/scales&gt;
    &lt;keys&gt;all&lt;/keys&gt;
&lt;/exercise&gt;
</programlisting>

</sect2>

<sect2><title>Exercises on music reading</title>

<para>optional tags for including controls:</para>

<variablelist>

<varlistentry><term>&lt;control_play&gt;</term>
<listitem>Include 'play' link. Default: do not include it.
    Value="play label|stop playing label". i.e.: "Play|Stop" Stop label
    is optional. Default labels: "Play|Stop".</listitem></varlistentry>

<varlistentry><term>&lt;control_solfa&gt;</term>
<listitem>Include 'solfa' link. Default: do not include it.
    Value="music read label|stop music reading label". i.e.:
    "Play|Stop". Stop label is optional.
    Default labels: "Read|Stop".</listitem></varlistentry>

<varlistentry><term>&lt;control_settings&gt;</term>
<listitem>Value="[key for storing the settings]"
    This param forces to include the 'settings' link. The
    key will be used both as the key for saving the user settings
    and as a tag to select the Setting Dialog options to allow.</listitem></varlistentry>

<varlistentry><term>&lt;control_go_back&gt;</term>
<listitem>id of chapter, section or theme, i.e.: "ch205".</listitem></varlistentry>

</variablelist>

<para>mandatory tags to set up the score composer:</para>

<variablelist>

<varlistentry><term>&lt;fragment&gt;</term>
<listitem>one tag for each fragment to use.</listitem></varlistentry>

<varlistentry><term>&lt;clef&gt;</term>
<listitem>one tag for each allowed clef. It includes the pitch scope.</listitem></varlistentry>

<varlistentry><term>&lt;time&gt;</term>
<listitem>a list of allowed time signatures, i.e.: "68,98,128".</listitem></varlistentry>

<varlistentry><term>&lt;key&gt;</term>
<listitem>keyword "all" or a list of allowed key signatures, i.e.: "Do,Fas".</listitem></varlistentry>

<varlistentry><term>&lt;max_interval&gt;</term>
<listitem>a number indicating the maximum allowed interval for two 
    consecutive notes. Default: 4</listitem></varlistentry>

</variablelist>

<para>Example</para>

<programlisting>
&lt;exercise type="TheoMusicReading" width="100%" height="300" border="0&gt;
    &lt;control_go_back&gt;ch205&lt;/control_go_back&gt;
    &lt;control_play&gt;1&lt;/control_play&gt;
    &lt;control_solfa&gt;1&lt;/control_solfa&gt;
    &lt;fragment&gt;24;(n * c g+)(n * c l g-),(n * c g+)(n * s)(n * s g-)&lt;/fragment&gt;
    &lt;clef&gt;Sol;a3;a5&lt;/clef&gt;
    &lt;clef&gt;Fa4;a2;f4&lt;/clef&gt;
    &lt;time&gt;24&lt;/time&gt;
    &lt;key&gt;Do&lt;/key&gt;
&lt;/lmobject&gt;
</programlisting>

</sect2>

</sect1>

</chapter>


<!-- =========================================================================== -->
<appendix><title>Params cross-reference</title>
<para>In following table, columns labelled as 1, 2, .. 8 indicate the applicability of
the described tag to each type of exercise, as listed here:</para>
<orderedlist>
    <listitem>score</listitem>
    <listitem>exercise type="TheoIntervals"</listitem>
    <listitem>exercise type="TheoKeySignatures"</listitem>
    <listitem>exercise type="EarIntervals"</listitem>
    <listitem>exercise type="EarCompareIntervals"</listitem>
    <listitem>exercise type="IdfyChord"</listitem>
    <listitem>exercise type="IdfyScales"</listitem>
    <listitem>exercise type="TheoMusicReading"</listitem>

</orderedlist>

<table>
<title>Supported params for exercises. Cross-reference table.</title>
<tgroup cols="10">
<thead>
<row><entry>parameter</entry><entry>1</entry><entry>2</entry><entry>3</entry><entry>4</entry><entry>5</entry>
    <entry>6</entry><entry>7</entry><entry>8</entry><entry>Obs.</entry></row>
</thead>
<tbody>

<row><entry>accidentals</entry>
    <entry>-</entry><entry>x</entry><entry>-</entry><entry>-</entry><entry>-</entry>
    <entry>-</entry><entry>-</entry><entry>-</entry>
    <entry>Defines if accidentals should be used. Possible values: "none | simple | double"</entry></row>
    
<row><entry>chords</entry>
    <entry>-</entry><entry>-</entry><entry>-</entry><entry>-</entry><entry>-</entry>
    <entry>x</entry><entry>-</entry><entry>-</entry>
    <entry>Defines the allowed chords for the exercise. Possible values: Keyword "all" or a 
    list of allowed chords.</entry></row>
    
<row><entry>clef</entry>
    <entry>-</entry><entry>x</entry><entry>x</entry><entry>-</entry><entry>-</entry>
    <entry>-</entry><entry>-</entry><entry>x</entry>
    <entry>The clefs to use in the exercise. Possible values: "Sol | Fa4 | Fa3 | Do4 
    | Do3 | Do2 | Do1".</entry></row>
    
<row><entry>control_go_back</entry>
    <entry>-</entry><entry>-</entry><entry>-</entry><entry>-</entry><entry>-</entry>
    <entry>-</entry><entry>-</entry><entry>x</entry>
    <entry>Include the 'go back to theory' link. Value: id of chapter, section or 
    theme (i.e.: "ch205").</entry></row>
    
<row><entry>control_measures</entry>
    <entry>x</entry><entry>-</entry><entry>-</entry><entry>-</entry><entry>-</entry>
    <entry>-</entry><entry>-</entry><entry>-</entry>
    <entry>Include 'play measure #' links, one per measure.</entry></row>
    
<row><entry>control_play</entry>
    <entry>x</entry><entry>-</entry><entry>-</entry><entry>-</entry><entry>-</entry>
    <entry>-</entry><entry>-</entry><entry>x</entry>
    <entry>Include 'play' link.</entry></row>
    
<row><entry>control_settings</entry>
    <entry>-</entry><entry>-</entry><entry>-</entry><entry>-</entry><entry>-</entry>
    <entry>x</entry><entry>x</entry><entry>x</entry>
    <entry>Include the 'settings' link to allow the user to configure the exercise.</entry></row>
    
<row><entry>control_solfa</entry>
    <entry>x</entry><entry>-</entry><entry>-</entry><entry>-</entry><entry>-</entry>
    <entry>-</entry><entry>-</entry><entry>x</entry>
    <entry>Include the 'solfa' link</entry></row>
    
<row><entry>fragment</entry>
    <entry>-</entry><entry>-</entry><entry>-</entry><entry>-</entry><entry>-</entry>
    <entry>-</entry><entry>-</entry><entry>x</entry>
    <entry>Information to set up the score composer. One tag for each fragment to use.</entry></row>
    
<row><entry>inversions</entry>
    <entry>-</entry><entry>-</entry><entry>-</entry><entry>-</entry><entry>-</entry>
    <entry>x</entry><entry>-</entry><entry>-</entry>
    <entry>Defines if inversions are allowed. Possible values: "0 | 1".</entry></row>
    
<row><entry>key</entry>
    <entry>-</entry><entry>-</entry><entry>-</entry><entry>-</entry><entry>-</entry>
    <entry>-</entry><entry>-</entry><entry>x</entry>
    <entry>Information to set up the score composer. Keyword "all" or a list of allowed key signatures, i.e.: "Do,Fas".</entry></row>
    
<row><entry>keys</entry>
    <entry>-</entry><entry>-</entry><entry>-</entry><entry>-</entry><entry>-</entry>
    <entry>x</entry><entry>x</entry><entry>-</entry>
    <entry>Possible keys to use in the exercise. Possible values: Keyword "all" or a list of allowed 
    key signatures, i.e.: "Do,Fas" Default: all.</entry></row>
    
<row><entry>max_accidentals</entry>
    <entry>-</entry><entry>-</entry><entry>-</entry><entry>-</entry><entry>-</entry>
    <entry>-</entry><entry>-</entry><entry>-</entry>
    <entry>Defines the maximum number of accidentals to use in the exercise. 
    Possible values: A number from 0..7.</entry></row>
    
<row><entry>max_interval</entry>
    <entry>-</entry><entry>-</entry><entry>x</entry><entry>x</entry><entry>x</entry>
    <entry>-</entry><entry>-</entry><entry>x</entry>
    <entry>Information to set up the score composer. A number indicating the maximum 
    allowed interval for two consecutive notes. Default: 4</entry></row>
    
<row><entry>mode</entry>
    <entry>-</entry><entry>-</entry><entry>x</entry><entry>-</entry><entry>-</entry>
    <entry>x</entry><entry>x</entry><entry>-</entry>
    <entry>The meaning of this parameter depends on the exercise. Usually it is to
    select the exercise type (theory or aural training) or the tonality (Major, Minor)</entry></row>
    
<row><entry>music</entry>
    <entry>x</entry><entry>-</entry><entry>-</entry><entry>-</entry><entry>-</entry>
    <entry>-</entry><entry>-</entry><entry>-</entry>
    <entry>The score to show. Either LDP language or MusicXML.</entry></row>
    
<row><entry>music_border</entry>
    <entry>x</entry><entry>-</entry><entry>-</entry><entry>-</entry><entry>-</entry>
    <entry>-</entry><entry>-</entry><entry>-</entry>
    <entry>To set up a border around the control (the score plus the optional links).</entry></row>
    
<row><entry>problem_type</entry>
    <entry>-</entry><entry>x</entry><entry>x</entry><entry>-</entry><entry>-</entry>
    <entry>-</entry><entry>-</entry><entry>-</entry>
    <entry>Defines the type of exercise: direct (i.e. "DeduceKey"), inverse (i.e.
    "WriteKey") or both.</entry></row>
    
<row><entry>play_mode</entry>
    <entry>-</entry><entry>-</entry><entry>-</entry><entry>-</entry><entry>-</entry>
    <entry>x</entry><entry>x</entry><entry>-</entry>
    <entry>Defines how to play the intervals or chords: melodic, harmonic, ascending.
    descending, etc.</entry></row>
    
<row><entry>scales</entry>
    <entry>-</entry><entry>-</entry><entry>-</entry><entry>-</entry><entry>-</entry>
    <entry>-</entry><entry>x</entry><entry>-</entry>
    <entry>Defines the allowed scales for the exercise. Possible values: 
    Keyword "all" or a list of allowed scales</entry></row>
    
<row><entry>show_key</entry>
    <entry>-</entry><entry>-</entry><entry>-</entry><entry>-</entry><entry>-</entry>
    <entry>x</entry><entry>x</entry><entry>-</entry>
    <entry>Defines if the key signature must be displayed or, instead, accidentals
    should be placed on individual notes. Possible values: "0 | 1". Default: 0 (do not
    display key signature)</entry></row>
    
<row><entry>time</entry>
    <entry>-</entry><entry>-</entry><entry>-</entry><entry>-</entry><entry>-</entry>
    <entry>-</entry><entry>-</entry><entry>x</entry>
    <entry>Information to set up the score composer. A list of allowed 
    time signatures, i.e.: "68,98,128".</entry></row>
    
<row><entry>score_type</entry>
    <entry>x</entry><entry>-</entry><entry>-</entry><entry>-</entry><entry>-</entry>
    <entry>-</entry><entry>-</entry><entry>-</entry>
    <entry>Defines the type of score being included. Possible values: "short | 
    short_nn_ss | pattern | full | XMLFile | LDPFile".</entry></row>
    
</tbody>
</tgroup>
</table>


</appendix>

<!-- =========================================================================== -->
<appendix id="ap2"><title>Tags cross-reference</title>

<para>
The present appendix list alphabetically all tags that are defined and supported in current
version of the LangTool processor program, used to compile the eMusicBooks:
</para>

<itemizedlist>

<listitem><link linkend="bookinfo">abstract</link> - 
    Used inside &lt;bookinfo&gt; for the text to include in the cover page after
    the book title.
</listitem>

<listitem><link linkend="bookinfo">author</link> - 
    Used inside &lt;bookinfo&gt; to include the name(s) of the book's author(s).
</listitem>

<listitem><link linkend="bookinfo">book</link> - 
    An eMusicBook. It is the main tag.
</listitem>

<listitem><link linkend="bookinfo">bookinfo</link> - 
    Meta-information for an eMusicBook
</listitem>

<listitem>chapter - 
    A chapter, as of a book
</listitem>

<listitem>content - 
    There is a restriction of XML the syntax:
    an XML file must content just one main tag, and all content must be children of this
    main tag. In eMusicBooks this main
    tag is the &lt;book&gt; tag. When a book is splitted in two or more files, for your
    convenience, I have defined tag &lt;content&gt;
    as a wrapper for all the content of an XML splitted file. So tag &lt;content&gt; is a way
    to by-pass the XML restriction before mentioned.
</listitem>

<listitem><link linkend="bookinfo">copyright</link> - 
    Copyright information about a document. It is used inside a &lt;bookinfo&gt; tag 
    for the text to include in the cover page after the abstract
</listitem>

<listitem>emphasis - 
    Emphasized text
</listitem>

<listitem><link linkend="exercises">exercise</link> - 
    To include an interactive music exercise.
</listitem>

<listitem><link linkend="bookinfo">holder</link> - 
    The name of the individual or organization that holds a copyright. It is 
    used inside &lt;copyright&gt; tag.
</listitem>

<listitem><link linkend="image">imagedata</link> - 
    To include an image (rendered inline). The filename to include is provided in
    attribute 'fileref'. Optional additional attributes are 'align' and 'valign'.
</listitem>

<listitem><link linkend="lists">itemizedlist</link> - 
    A list in which each entry is marked with a bullet or other dingbat.
</listitem>

<listitem>leaflet - 
    An eMusicBook leaflet. It is the main tag, used instead of &lt;book&gt; for single
    page books.
</listitem>

<listitem>leafletcontent - 
    Used instead of &lt;theme&gt; tag for leaflets. A wrapper for the leaflet content.
</listitem>

<listitem><link linkend="bookinfo">legalnotice</link> - 
    A statement of legal obligations or requirements.
</listitem>

<listitem><link linkend="links">link</link> - 
    A hypertext link
</listitem>

<listitem><link linkend="lists">listitem</link> - 
    A wrapper for the elements of a list item.
</listitem>

<listitem><link linkend="lists">orderedlist</link> - 
    A list in which each entry is marked with a sequentially incremented label.
</listitem>

<listitem>para - 
    A paragraph.
</listitem>

<listitem>part - 
    A section inside a theme.
</listitem>

<listitem><link linkend="scores">score</link> - 
    To include an interactive music score.
</listitem>

<listitem>section - 
    A section inside a chapter. Can be used recursively, that is, a section can 
    also have sections.
</listitem>

<listitem>simplelist - 
    An undecorated list of single words or short phrases
</listitem>

<listitem><link linkend="theme">theme</link> - 
    A wrapper for the information to display in a page.
</listitem>

<listitem>title - 
    The text of the title of a book, chapter, section, theme or part of a document.
</listitem>

<listitem>titleabbrev - 
    Holds an abbreviated version of a &lt;title&gt;. It is used for the text
    in running headers or footers, when the proper title is too long to be used conveniently.
    It must be defined before the &lt;title&gt; tag.
</listitem>

<listitem><link linkend="creating_toc">tocimage</link> - 
    A reference to an image file (.png, jpg, etc.) to be used in the TOC
</listitem>

<listitem><link linkend="links">ulink</link> - 
    A link that addresses its target by means of a URL (Uniform Resource Locator)
</listitem>

<listitem><link linkend="bookinfo">year</link> - 
    The year of publication of a document; used as child of &lt;copyright&gt; tag.
</listitem>

</itemizedlist>
    

</appendix>


<!-- =============================================================== -->
<!-- ======================    The end     ========================= -->
<!-- =============================================================== -->


</book>
